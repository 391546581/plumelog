{"remainingRequest":"/Users/tank/tank-workspace/easy_log/easy_log_ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tank/tank-workspace/easy_log/easy_log_ui/src/views/Home.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/tank/tank-workspace/easy_log/easy_log_ui/src/views/Home.vue","mtime":1589183975369},{"path":"/Users/tank/tank-workspace/easy_log/easy_log_ui/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tank/tank-workspace/easy_log/easy_log_ui/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/tank/tank-workspace/easy_log/easy_log_ui/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/tank/tank-workspace/easy_log/easy_log_ui/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tank/tank-workspace/easy_log/easy_log_ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tank/tank-workspace/easy_log/easy_log_ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgpwcmUgewogIC8vIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDsgICAgICAgLyogY3NzLTMgKi8KICAvLyB3aGl0ZS1zcGFjZTogLW1vei1wcmUtd3JhcDsgIC8qIE1vemlsbGEsIHNpbmNlIDE5OTkgKi8KICAvLyB3aGl0ZS1zcGFjZTogLXByZS13cmFwOyAgICAgIC8qIE9wZXJhIDQtNiAqLwogIC8vIHdoaXRlLXNwYWNlOiAtby1wcmUtd3JhcDsgICAgLyogT3BlcmEgNyAqLwogIHdvcmQtd3JhcDogYnJlYWstd29yZDsgICAgICAgLyogSW50ZXJuZXQgRXhwbG9yZXIgNS41KyAqLwp9CgoucG5sX3dyYXBlcgp7CiAgcGFkZGluZy1ib3R0b206ODBweDsKICAucG5sX2ZpbHRlcnMKICB7CiAgICBwYWRkaW5nLWJvdHRvbToyMHB4OyAKICAgIG5hdnsKICAgICAgbWFyZ2luLWJvdHRvbToyMHB4OwogICAgfQogIH0KICAucGFnZV9uYXYKICB7CiAgICBwb3NpdGlvbjpmaXhlZDsKICAgIGJvdHRvbTowOwogICAgd2lkdGg6MTAwJTsKICAgIHBhZGRpbmc6MTVweCAwOwogICAgYmFja2dyb3VuZDojZmZmOwogICAgYm9yZGVyLXRvcDoxcHggc29saWQgI2NjYzsKICB9Cn0KCi50YWJsZV9kZXRhaWwgewogIHBvc2l0aW9uOnJlbGF0aXZlOwogIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7CiAgdGhlYWQgewogICAgcG9zaXRpb246c3RpY2t5OwogICAgICB0b3A6IDA7CiAgICB0aHsKICAgICAgcG9zaXRpb246c3RpY2t5OwogICAgICB0b3A6IC0xcHg7CiAgICAgIGJhY2tncm91bmQ6I2ZmZjsKICAgICAgYm94LXNoYWRvdzogMCAycHggMnB4IC0xcHggcmdiYSgwLCAwLCAwLCAwLjEpOwogICAgICB6LWluZGV4Ojk5OwogICAgfQogIH0KCiAgdGR7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAmLmljb257CiAgICAgICAmOmhvdmVyewogICAgICAgIGl7CiAgICAgICAgICBkaXNwbGF5OiBpbmxpbmU7CiAgICAgICAgfQogICAgICB9CiAgICAgIGl7CiAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICB0b3A6IDE1cHg7CiAgICAgICAgIHJpZ2h0OjVweDsKICAgICAgICAgZm9udC1zaXplOiAxNnB4OwogICAgICAgICBkaXNwbGF5Om5vbmU7CiAgICAgIH0KICAgICAKICAgIH0KICB9CgogIC5idG57CiAgICBmb250LXNpemU6MTRweCAhaW1wb3J0YW50OwogIH0KCiAgdHIuV0FSTnsKICAgIHRkewogICAgICBiYWNrZ3JvdW5kOiAjZmZmMWQ3OwogICAgfQogIH0KCiAgdHIuRVJST1J7CiAgICB0ZHsKICAgICAgYmFja2dyb3VuZDogI2Y3YjhhODsKICAgIH0KICB9CgogIHRyOmhvdmVyewogICAgdGR7CiAgICAgIGJhY2tncm91bmQ6I2UzZWNmMzsKICAgIH0KICB9Cn0KCi5tb2RhbC1ib2R5CnsKICB0YWJsZXsKICAgIHRyewogICAgICB0ZHsKICAgICAgICB2ZXJ0aWNhbC1hbGlnbjp0b3A7CiAgICAgICAgcGFkZGluZzoxMHB4IDA7CiAgICAgICAgYm9yZGVyLWJvdHRvbToxcHggZG90dGVkICNlY2VjZWM7CiAgICAgICAgLmNvZGVfd3JhcAogICAgICAgIHsKICAgICAgICAgIHdpZHRoOjk1MHB4OwogICAgICAgIH0KICAgICAgfQogICAgICAua2V5ewogICAgICAgIHdpZHRoOjE1MHB4OwogICAgICAgIGZvbnQtd2VpZ2h0OjcwMDsKICAgICAgICB0ZXh0LWFsaWduOnJpZ2h0OwogICAgICAgIHBhZGRpbmc6MTBweCA1MHB4IDEwcHggMTBweDsKICAgICAgfQogICAgfQogICAgCiAgfQp9CgoudGRfY250CnsKICBlbSB7CiAgICBiYWNrZ3JvdW5kOnllbGxvdzsKICB9Cn0KCi5tb2RhbC1ib2R5CnsKICB0ZXh0LWFsaWduOmxlZnQ7CiAgZW0gewogICAgYmFja2dyb3VuZDp5ZWxsb3c7CiAgfQp9CgoK"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAygBA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"pnl_wraper\">\n    <div class=\"pnl_filters\">\n      <div class=\"alert alert-danger\" v-if=\"danger_str\" role=\"alert\">\n        {{danger_str}}\n      </div>\n      <nav aria-label=\"breadcrumb\">\n        <ol class=\"breadcrumb\">\n          <li class=\"breadcrumb-item active\" aria-current=\"page\">\n            <h3><Icon type=\"ios-bug\" />&nbsp;日志查询系统</h3>\n          </li>\n        </ol>\n      </nav>\n      <iframe id=\"rfFrame\" name=\"rfFrame\" src=\"about:blank\" style=\"display:none;\"></iframe> \n      <form action=\"\" target=\"rfFrame\" ref=\"form\" autocomplete=\"on\">\n        <table class='tbl_filters'>\n          <tbody>\n            <tr>\n              <td class=\"key\">应用名称</td>\n              <td>\n                <Input class=\"txt\" name=\"appName\" v-model=\"filter.appName\" placeholder=\"搜索多个请用逗号或空格隔开\" :clearable=\"true\" />\n              </td>\n            </tr>\n            <tr>\n              <td class=\"key\">日志等级</td>\n              <td>\n                <Select v-model=\"filter.logLevel\" placeholder=\"请选择日志等级\">\n                    <Option value=\"\" key=\"ALL\">所有</Option>\n                    <Option value=\"INFO\" key=\"INFO\">INFO</Option>\n                    <Option value=\"ERROR\" key=\"ERROR\">ERROR</Option>\n                    <Option value=\"WARN\" key=\"WARN\">WARN</Option>\n                    <Option value=\"DEBUG\" key=\"DEBUG\">DEBUG</Option>\n                </Select>\n              </td>\n            </tr>\n            <tr>\n              <td class=\"key\">服务器名称</td>\n              <td>\n                <Input class=\"txt\" name=\"serverName\" v-model=\"filter.serverName\" placeholder=\"搜索多个请用逗号或空格隔开\" :clearable=\"true\"/>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n\n        <table class='tbl_filters'>\n          <tr>\n              <td class=\"key\">模块名</td>\n              <td>\n                <Input class=\"txt\"  name=\"className\" v-model=\"filter.className\" placeholder=\"搜索多个请用逗号或空格隔开\" :clearable=\"true\"/>\n              </td>\n            </tr>\n            <tr>\n              <td class=\"key\">追踪码</td>\n              <td>\n                <Input class=\"txt\" name=\"traceId\" v-model=\"filter.traceId\" placeholder=\"搜索多个请用逗号或空格隔开\" :clearable=\"true\"/>\n              </td>\n            </tr>\n            <tr>\n              <td class=\"key\">日期和时间</td>\n              <td>\n                  <DatePicker ref='datePicker' v-model=\"dateTimeRange\" :editable=\"true\" @on-change=\"dateChange\" type=\"datetimerange\" :options=\"dateOption\" format=\"yyyy-MM-dd HH:mm\" placeholder=\"选择日期与时间\" style=\"width: 378px\"></DatePicker>\n              </td>\n            </tr>\n        </table>\n      </form>\n    <div style=\"clear:both\"></div>\n      <table class=\"tbl_filters\">\n        <tr>\n            <td class=\"key\">内容</td>\n            <td>\n              <input class=\"txt ivu-input\" @keyup.enter=\"doSearch()\" style=\"width:907px\" placeholder=\"输入搜索内容\" v-model=\"searchKey\" />\n            </td>\n          </tr>\n          <tr>\n            <td></td>\n            <td style='padding-top:20px'>\n              <Button type=\"primary\" icon=\"ios-search\" @click=\"doSearch\">查询</Button>\n              <Button style=\"margin-left:10px\" @click=\"clear\">重置</Button>\n            </td>\n          </tr>\n      </table>\n       <div style=\"clear:both\"></div>\n    </div>\n\n    <div style=\"float:right;margin-right:20px;margin-bottom:5px\">共 <b>{{list.total}}</b> 条数据</div>\n   \n    <table v-if=\"list.hits.length>0\" cellspacing=\"0\" cellpadding=\"0\"  class=\"table table-striped table_detail\">\n      <thead>\n        <tr>\n          <th v-for=\"item in contentItems\" :key=\"item.name\" scope=\"col\">{{item.name}}</th>\n          <th scope=\"col\">操作</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in list.hits\" :class=\"item._source.logLevel\" :key=\"item._id\">\n          <td class=\"icon\">{{item._source.appName}}<Icon type=\"ios-search\" @click=\"doSearch('appName',item)\" /></td>\n          <td class=\"icon\">{{item._source.logLevel}}<Icon type=\"ios-search\" @click=\"doSearch('logLevel',item)\"/></td>\n          <td class=\"icon\">{{item._source.serverName}}<Icon type=\"ios-search\" @click=\"doSearch('serverName',item)\"/></td>\n          <td class=\"icon\">{{item._source.traceId}}<Icon type=\"ios-search\" v-if=\"item._source.traceId\" @click=\"doSearch('traceId',item)\" /></td>\n          <td class=\"icon\" style=\"width:150px\">{{item._source.className | substr}}<Icon type=\"ios-search\" @click=\"doSearch('className',item)\" /></td>\n          <td>{{item._source.dtTime | filterTime}}</td>\n          <td class='td_cnt' v-html=\"showContent(item)\"></td>\n          <td><button class=\"btn btn-primary\" @click=\"showDetail(item)\">详情</button></td>\n        </tr>\n      </tbody>\n    </table>\n    <nav v-if=\"list.total && parseInt(list.total/size) > 0\" class=\"page_nav\" aria-label=\"Page navigation example\">\n      <ul class=\"pagination justify-content-center\">\n        <li class=\"page-item\" :class=\"{'disabled': !isShowLastPage }\">\n          <a class=\"page-link\" href=\"javascript:void(0)\" @click=\"prevePage\" tabindex=\"-1\">上一页</a>\n        </li>\n        <li class=\"page-item\" :class=\"{'disabled': !haveNextPage }\">\n          <a class=\"page-link\" href=\"javascript:void(0)\" @click=\"nextPage\">下一页</a>\n        </li>\n        <li class=\"page-item\"><div class=\"page-count\">第{{parseInt(from/size)+1}}页 / 共{{  parseInt(list.total/size)+1}}页</div></li>\n      </ul>\n    </nav>\n\n    <!-- Modal -->\n    \n    <div class=\"modal fade show\" style=\"display:block\" v-if=\"content.title\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalScrollableTitle\" aria-hidden=\"true\">\n      <div class=\"modal-dialog modal-dialog-scrollable\" style=\"max-width:1200px\" role=\"document\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\">{{content.title}}</h5>\n            <button type=\"button\" class=\"close\" @click=\"content={}\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n          </div>\n          <div class=\"modal-body\">\n              <table>\n                <tr v-for=\"item in contentItems\" :key=\"item.value\">\n                  <td class=\"key\">{{item.name}}</td>\n                  <td v-if=\"item.value == 'dtTime'\">{{content._source[item.value] | filterTime}}</td>\n                  <td v-else-if=\"item.value == 'content'\">\n                    <div class=\"code_wrap\">\n                      <pre v-html=\"hightLightCode(content.content)\"></pre>\n                    </div>\n                  </td>\n                  <td v-else>{{content._source[item.value]}}</td>\n                </tr>\n              </table>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" @click=\"content={}\"  data-dismiss=\"modal\">关闭</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"modal-backdrop fade show\" v-if=\"content.title\"></div>\n\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\n// import HelloWorld from \"@/components/HelloWorld.vue\";\nimport axios from '@/services/http'\nimport _ from 'lodash'\nimport moment from 'moment'\nimport '@/assets/prism.js' \nimport '@/assets/prism.css'\nimport 'view-design/dist/styles/iview.css';\nimport * as $config from '@/config.json'\n\n\nexport default {\n  name: \"Home\",\n  data(){\n   return {\n     api: process.env.api,\n     dateOption:{\n       shortcuts: [\n         {\n              text: '15分钟',\n              value () {\n                  const end = new Date();\n                  const start = new Date();\n                  start.setTime(start.getTime() - 60 * 1000 * 15);\n                  return [start, end];\n              }\n          },\n          {\n              text: '30分钟',\n              value () {\n                  const end = new Date();\n                  const start = new Date();\n                  start.setTime(start.getTime() - 60 * 1000 * 30);\n                  return [start, end];\n              }\n          },\n          {\n              text: '1小时',\n              value () {\n                  const end = new Date();\n                  const start = new Date();\n                  start.setTime(start.getTime() - 3600 * 1000);\n                  return [start, end];\n              }\n          },\n          {\n              text: '24小时',\n              value () {\n                  const end = new Date();\n                  const start = new Date();\n                  start.setTime(start.getTime() - 3600 * 1000 * 24);\n                  return [start, end];\n              }\n          },\n          {\n              text: '1周',\n              value () {\n                  const end = new Date();\n                  const start = new Date();\n                  start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\n                  return [start, end];\n              }\n          },\n          {\n              text: '当天',\n              value () {\n                  const end = new Date();\n                  var start = new Date();\n                  start.setTime(start.setHours(0,0));\n                  return [start, end];\n              }\n          }\n      ],\n       disabledDate(date){\n         return date && date.valueOf() > Date.now();\n       }\n     },\n     contentItems:[\n       {\n        'name': '应用名称',\n        'value': 'appName'\n       },\n       {\n        'name': '日志等级',\n        'value': 'logLevel'\n       },\n       {\n        'name': '服务器名称',\n        'value': 'serverName'\n       },\n       {\n        'name': '追踪码',\n        'value': 'traceId'\n       },\n       {\n        'name': '模块名',\n        'value': 'className'\n       },\n       {\n        'name': '时间',\n        'value': 'dtTime'\n       },\n       {\n        'name': '内容',\n        'value': 'content'\n       },\n       \n     ],\n     dateTimeRange:[],\n     content:{},\n     searchKey:'',\n     danger_str:'',\n     filter:{\n       \"logLevel\":'',\n       \"appName\":\"\",\n       \"traceId\":\"\"\n     },\n     list:{\n       hits:[]\n     },\n     size:30,\n     from:0\n   }\n  },\n  components: {\n    // HelloWorld\n  },\n  filters:{\n    substr(str){\n      if(str.length>50){\n        return str.substring(0,50)+'...';\n      }\n      return str;\n    },\n    filterTime(date){\n      return moment(date).format('YYYY/MM/DD HH:mm:ss')\n    }\n  },\n  computed:{\n    isShowLastPage(){\n      return this.from > 0 \n    },\n    haveNextPage(){\n      if(this.list.total>=(this.from+this.size))\n        return true\n      else\n        return false\n    }\n  },\n  methods:{\n    getShouldFilter(){\n      let filters = [];\n      let date=[];\n      for(let itemKey in this.filter)\n      {\n        if(this.filter[itemKey]){\n           filters.push({\n            \"match\":{\n              [itemKey]:{\n                \"query\":this.filter[itemKey].replace(/,/g,' '),\n                // \"type\":\"phrase\"\n              }\n            }\n          })\n        }\n      }\n\n      if(this.searchKey){\n        filters.push({\n            \"query_string\":{\n              \"query\": this.searchKey,\n              \"default_field\": \"content\"\n            }\n          })\n      }\n\n      //判断日期\n      if(this.dateTimeRange.length>0 && this.dateTimeRange[0]!=''){\n        let startDate=new Date(this.dateTimeRange[0]);\n        let endDate=new Date(this.dateTimeRange[1]);\n        filters.push({\n          \"range\":{\n            \"dtTime\":{\n              \"gte\": Date.parse(startDate),\n              \"lt\": Date.parse(endDate),\n            }\n          }\n        })\n      }\n\n      return filters\n    },\n    clear(){\n     this.filter = {\n       \"logLevel\":'',\n       \"appName\":\"\",\n       \"traceId\":\"\"\n     }\n     this.searchKey = \"\";\n     this.dateTimeRange = [];\n     this.$refs.datePicker.internalValue=[];\n     this.doSearch();\n    },\n    dateChange(){\n        let startDate = this.dateTimeRange[0]\n        let endDate = this.dateTimeRange[1]\n        if(startDate.getHours() == 0 && startDate.getMinutes() ==0 && endDate.getHours() == 0 && endDate.getMinutes() == 0){\n          this.dateTimeRange[1].setHours(23,59)\n          this.$refs.datePicker.internalValue = _.clone(this.dateTimeRange);\n        }\n    },\n    hightLightCode(code){\n      if(code.indexOf('java.')>-1){\n        return Prism.highlight(code, Prism.languages.stackjava, 'stackjava');\n      }\n      else\n      {\n        return code;\n      }\n    },\n    init(){\n      let from = this.$route.query.from || 0\n      from = parseInt(from);\n      this.filter = JSON.parse(this.$route.query.filter || '{}')\n      this.from = from;\n    },\n    checkExistsIndex(dateList) {\n      var promises=[];\n    \n      for(var date of dateList){\n           promises.push(new Promise((res,reject)=>{\n               axios.head('/'+date)\n                    .then(r=>{\n                        res(true)\n                    })\n                    .catch(error=>{\n                      res(false)\n                    })\n           }))\n      }\n\n      return Promise.all(promises).then(data=>{\n        var existDateList=[];\n        for(var i=0;i<dateList.length;i++)\n        {\n          if(data[i]){\n            existDateList.push(dateList[i])\n          }\n        }\n        return existDateList\n      })\n     \n    },\n    showContent(item){\n      var str = (_.get(item,\"highlight.content[0]\",\"\") || _.get(item,\"_source.content\",\"\"))\n      if(str.length>30)\n      {\n        return str.substring(0,30)+'...'\n      }\n      return str;\n    },\n    showDetail(item){\n      this.content = {\n        \"title\":'日志详情',\n        content: _.get(item,\"highlight.content[0]\",\"\") || _.get(item,\"_source.content\",\"\"),\n        ...item\n      }\n    },\n    doSearch(keyName,item){\n\n      this.$refs.form.submit();\n\n      if(keyName && item){\n        this.filter[keyName] = item._source[keyName]\n      }\n\n      //列出范围内的日期\n      let dateList=[];\n      let startDate = _.clone(this.dateTimeRange[0]);\n\n      let shouldFilter = this.getShouldFilter();\n      \n      if(startDate){\n         while(startDate<=this.dateTimeRange[1]){\n          dateList.push($config.prefix+moment(startDate).format('YYYYMMDD'))\n          startDate = new Date(startDate.setDate(startDate.getDate()+1));\n        }\n      }\n     \n      if(dateList.length==0){\n        dateList.push($config.prefix+moment().format('YYYYMMDD'));\n      }\n\n      //this.checkExistsIndex(dateList).then(existDateList=>{\n          \n          let url= '/getInfo?index='+dateList.join(',')+'&size='+this.size+\"&from=\"+this.from\n\n          let esFilter = {\n            \"query\":{\n              \"bool\":{\n                \"must\":[\n                  ...shouldFilter\n                ]\n              }\n            },\n            \"highlight\": {\n                \"fields\" : {\n                    \"content\" : {}\n                }\n            },\n            \"sort\":[\n              {\n                \"dtTime\":\"desc\"\n              }\n            ]\n          };\n\n          axios.post(url,esFilter).then(data=>{\n            this.list = _.get(data,'data.hits')\n          })\n\n          this.$router.push({\n            name:'Home',\n            query:{\n              from:this.from,\n              filter: JSON.stringify(this.filter)\n            }\n          }).catch(err=>{\n            \n          })\n      //});\n    },\n    prevePage(){\n      let from = this.from - this.size\n      if(from < 0)\n      {\n        from = 0;\n      }\n      this.from = from;   \n      this.doSearch();   \n    },\n    nextPage(){\n      let from = this.from + this.size\n      this.from = from;   \n      this.doSearch();\n    }\n  },\n  watch:{\n    searchKey(){\n      this.from = 0;\n    },\n    \"filter\":{\n      handler(){\n        this.from = 0;\n      },\n      deep:true\n    }\n  },\n  mounted(){\n    this.init();\n    this.doSearch();\n  }\n};\n</script>\n<style lang=\"less\">\n\n  pre {\n    // white-space: pre-wrap;       /* css-3 */\n    // white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */\n    // white-space: -pre-wrap;      /* Opera 4-6 */\n    // white-space: -o-pre-wrap;    /* Opera 7 */\n    word-wrap: break-word;       /* Internet Explorer 5.5+ */\n  }\n\n  .pnl_wraper\n  {\n    padding-bottom:80px;\n    .pnl_filters\n    {\n      padding-bottom:20px; \n      nav{\n        margin-bottom:20px;\n      }\n    }\n    .page_nav\n    {\n      position:fixed;\n      bottom:0;\n      width:100%;\n      padding:15px 0;\n      background:#fff;\n      border-top:1px solid #ccc;\n    }\n  }\n\n  .table_detail {\n    position:relative;\n    border-collapse: collapse;\n    thead {\n      position:sticky;\n        top: 0;\n      th{\n        position:sticky;\n        top: -1px;\n        background:#fff;\n        box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.1);\n        z-index:99;\n      }\n    }\n\n    td{\n      position: relative;\n      &.icon{\n         &:hover{\n          i{\n            display: inline;\n          }\n        }\n        i{\n           cursor: pointer;\n           position: absolute;\n           top: 15px;\n           right:5px;\n           font-size: 16px;\n           display:none;\n        }\n       \n      }\n    }\n\n    .btn{\n      font-size:14px !important;\n    }\n\n    tr.WARN{\n      td{\n        background: #fff1d7;\n      }\n    }\n\n    tr.ERROR{\n      td{\n        background: #f7b8a8;\n      }\n    }\n\n    tr:hover{\n      td{\n        background:#e3ecf3;\n      }\n    }\n  }\n\n  .modal-body\n  {\n    table{\n      tr{\n        td{\n          vertical-align:top;\n          padding:10px 0;\n          border-bottom:1px dotted #ececec;\n          .code_wrap\n          {\n            width:950px;\n          }\n        }\n        .key{\n          width:150px;\n          font-weight:700;\n          text-align:right;\n          padding:10px 50px 10px 10px;\n        }\n      }\n      \n    }\n  }\n\n  .td_cnt\n  {\n    em {\n      background:yellow;\n    }\n  }\n\n  .modal-body\n  {\n    text-align:left;\n    em {\n      background:yellow;\n    }\n  }\n\n  \n</style>\n<style lang=\"less\" scoped>\n\n  .tbl_filters {\n    float:left;\n    tr{\n      td{\n        height:30px;\n        line-height:30px;\n        text-align:left;\n        padding-bottom:10px;\n        &.key{\n          padding-left:20px;\n          text-align:right;\n          font-weight:700;\n          width:150px;\n          padding-right:30px;\n        }\n        .txt{\n          width:378px;\n        }\n      }\n    }\n  }\n\n  .breadcrumb\n  {\n    position: relative;\n    padding:20px 10px 20px 50px;\n  }\n  .pnl_search\n  {\n    position: absolute;\n    top:10px;\n    left:300px;\n    width:600px;\n  }\n\n   .link_trans\n    {\n      color: #1313bd;\n      text-decoration:underline;\n      cursor: pointer;\n    }\n\n    .page-count\n    {\n      padding:.5rem 1rem;\n      \n    }\n</style>"]}]}